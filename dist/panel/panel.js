(()=>{var C=(e,t)=>{let r=document.querySelector(e);if(!r)throw`Element (${e}) not found.`;r.addEventListener("click",t),document.addEventListener("beforeunload",()=>{r.removeEventListener("click",t)})};var q=e=>{let t=document.querySelector(`#button-${e.id}`);if(!t)throw`Cell for button not found: "#button-${e.id}"`;let r=document.createElement("button"),n=new URL(e.url);r.classList.add("href-button"),r.innerText=n.pathname,t.appendChild(r);let s=document.querySelector(`#report-${e.id}`);if(!s)throw`Report tr not found: "#report-${e.id}"`;let o=()=>{s.classList.toggle("hidden")};C(`#button-${e.id} button.href-button`,o)};var z=[],ne="",k,u={entries:new Proxy(z,{set:se}),isRecording:!0,allowedResponseMimeTypesRegExps:[/text\/\w/,/application\/(json|csv)/],allowedResourceTypes:["xhr","fetch"],filter:ne};function se(e,t,r){return e[t]=r,!k&&(k=document.querySelector("#reset"),!k)||(z.length===0?k.classList.add("hidden"):k.classList.remove("hidden")),!0}var _=(e,t)=>{let r=document.querySelector(`#tr-${e.id}`);if(!r){console.error(`Table row of id "${e.id}" not found`);return}let n=P(e.url,t);r.classList.contains("hidden")&&!n&&r.classList.remove("hidden"),r.classList.contains("hidden")===!1&&n&&r.classList.add("hidden")},P=(e,t)=>t.length>2&&new URL(e).href.includes(t)===!1;var j=e=>{document.querySelector("#table tbody").insertAdjacentHTML("beforeend",`<tr id="tr-${e.id}" class="${P(e.url,u.filter)?"hidden":""}">
      <td>
        <time datetime="${e.dateTime}" class="time">
          ${new Date(e.dateTime).toLocaleTimeString()}
        </time>
      </td>
      <td>${e.method}</td>
      <td>
        <response-status status="${e.status}"></response-status>
      </td>
      <td class="endpoint" id="button-${e.id}"></td>
    </tr>
    <tr class="hidden report" id="report-${e.id}">
      <td colspan="4">
        <copy-button target-selector="#report-${e.id} pre"></copy-button>
        <pre>${e.report}</pre>
      </td>
    </tr>
    `),q(e)};var N=()=>{if(!confirm("Are you sure to clean up the entire list?"))return;u.entries.length=0;let t=document.querySelector("#table tbody");if(!t)throw"#table element not found";t.innerHTML=""};var O=e=>typeof e=="string";var ie=()=>{let e=document.querySelector("status-dot");if(!e)throw"status-dot not found";e.setAttribute("is-recording",u.isRecording.toString())},K=e=>{u.isRecording=!u.isRecording,e.target.innerText=u.isRecording?"Pause":"Restore",ie()};var ae=Object.prototype.toString,L=Array.isArray||function(t){return ae.call(t)==="[object Array]"};function I(e){return typeof e=="function"}function ce(e){return L(e)?"array":typeof e}function B(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function F(e,t){return e!=null&&typeof e=="object"&&t in e}function ue(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var le=RegExp.prototype.test;function pe(e,t){return le.call(e,t)}var de=/\S/;function fe(e){return!pe(de,e)}var he={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function me(e){return String(e).replace(/[&<>"'`=\/]/g,function(r){return he[r]})}var ge=/\s*/,ye=/\s+/,W=/\s*=/,ve=/\s*\}/,be=/#|\^|\/|>|\{|&|=|!/;function we(e,t){if(!e)return[];var r=!1,n=[],s=[],o=[],i=!1,a=!1,c="",l=0;function f(){if(i&&!a)for(;o.length;)delete s[o.pop()];else o=[];i=!1,a=!1}var v,E,U;function D(b){if(typeof b=="string"&&(b=b.split(ye,2)),!L(b)||b.length!==2)throw new Error("Invalid tags: "+b);v=new RegExp(B(b[0])+"\\s*"),E=new RegExp("\\s*"+B(b[1])),U=new RegExp("\\s*"+B("}"+b[1]))}D(t||g.tags);for(var p=new $(e),w,h,m,x,A,T;!p.eos();){if(w=p.pos,m=p.scanUntil(v),m)for(var H=0,re=m.length;H<re;++H)x=m.charAt(H),fe(x)?(o.push(s.length),c+=x):(a=!0,r=!0,c+=" "),s.push(["text",x,w,w+1]),w+=1,x===`
`&&(f(),c="",l=0,r=!1);if(!p.scan(v))break;if(i=!0,h=p.scan(be)||"name",p.scan(ge),h==="="?(m=p.scanUntil(W),p.scan(W),p.scanUntil(E)):h==="{"?(m=p.scanUntil(U),p.scan(ve),p.scanUntil(E),h="&"):m=p.scanUntil(E),!p.scan(E))throw new Error("Unclosed tag at "+p.pos);if(h==">"?A=[h,m,w,p.pos,c,l,r]:A=[h,m,w,p.pos],l++,s.push(A),h==="#"||h==="^")n.push(A);else if(h==="/"){if(T=n.pop(),!T)throw new Error('Unopened section "'+m+'" at '+w);if(T[1]!==m)throw new Error('Unclosed section "'+T[1]+'" at '+w)}else h==="name"||h==="{"||h==="&"?a=!0:h==="="&&D(m)}if(f(),T=n.pop(),T)throw new Error('Unclosed section "'+T[1]+'" at '+p.pos);return Te(Ee(s))}function Ee(e){for(var t=[],r,n,s=0,o=e.length;s<o;++s)r=e[s],r&&(r[0]==="text"&&n&&n[0]==="text"?(n[1]+=r[1],n[3]=r[3]):(t.push(r),n=r));return t}function Te(e){for(var t=[],r=t,n=[],s,o,i=0,a=e.length;i<a;++i)switch(s=e[i],s[0]){case"#":case"^":r.push(s),n.push(s),r=s[4]=[];break;case"/":o=n.pop(),o[5]=s[2],r=n.length>0?n[n.length-1][4]:t;break;default:r.push(s)}return t}function $(e){this.string=e,this.tail=e,this.pos=0}$.prototype.eos=function(){return this.tail===""};$.prototype.scan=function(t){var r=this.tail.match(t);if(!r||r.index!==0)return"";var n=r[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};$.prototype.scanUntil=function(t){var r=this.tail.search(t),n;switch(r){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=n.length,n};function S(e,t){this.view=e,this.cache={".":this.view},this.parent=t}S.prototype.push=function(t){return new S(t,this)};S.prototype.lookup=function(t){var r=this.cache,n;if(r.hasOwnProperty(t))n=r[t];else{for(var s=this,o,i,a,c=!1;s;){if(t.indexOf(".")>0)for(o=s.view,i=t.split("."),a=0;o!=null&&a<i.length;)a===i.length-1&&(c=F(o,i[a])||ue(o,i[a])),o=o[i[a++]];else o=s.view[t],c=F(s.view,t);if(c){n=o;break}s=s.parent}r[t]=n}return I(n)&&(n=n.call(this.view)),n};function d(){this.templateCache={_cache:{},set:function(t,r){this._cache[t]=r},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}d.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};d.prototype.parse=function(t,r){var n=this.templateCache,s=t+":"+(r||g.tags).join(":"),o=typeof n<"u",i=o?n.get(s):void 0;return i==null&&(i=we(t,r),o&&n.set(s,i)),i};d.prototype.render=function(t,r,n,s){var o=this.getConfigTags(s),i=this.parse(t,o),a=r instanceof S?r:new S(r,void 0);return this.renderTokens(i,a,n,t,s)};d.prototype.renderTokens=function(t,r,n,s,o){for(var i="",a,c,l,f=0,v=t.length;f<v;++f)l=void 0,a=t[f],c=a[0],c==="#"?l=this.renderSection(a,r,n,s,o):c==="^"?l=this.renderInverted(a,r,n,s,o):c===">"?l=this.renderPartial(a,r,n,o):c==="&"?l=this.unescapedValue(a,r):c==="name"?l=this.escapedValue(a,r,o):c==="text"&&(l=this.rawValue(a)),l!==void 0&&(i+=l);return i};d.prototype.renderSection=function(t,r,n,s,o){var i=this,a="",c=r.lookup(t[1]);function l(E){return i.render(E,r,n,o)}if(c){if(L(c))for(var f=0,v=c.length;f<v;++f)a+=this.renderTokens(t[4],r.push(c[f]),n,s,o);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")a+=this.renderTokens(t[4],r.push(c),n,s,o);else if(I(c)){if(typeof s!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(r.view,s.slice(t[3],t[5]),l),c!=null&&(a+=c)}else a+=this.renderTokens(t[4],r,n,s,o);return a}};d.prototype.renderInverted=function(t,r,n,s,o){var i=r.lookup(t[1]);if(!i||L(i)&&i.length===0)return this.renderTokens(t[4],r,n,s,o)};d.prototype.indentPartial=function(t,r,n){for(var s=r.replace(/[^ \t]/g,""),o=t.split(`
`),i=0;i<o.length;i++)o[i].length&&(i>0||!n)&&(o[i]=s+o[i]);return o.join(`
`)};d.prototype.renderPartial=function(t,r,n,s){if(n){var o=this.getConfigTags(s),i=I(n)?n(t[1]):n[t[1]];if(i!=null){var a=t[6],c=t[5],l=t[4],f=i;c==0&&l&&(f=this.indentPartial(i,l,a));var v=this.parse(f,o);return this.renderTokens(v,r,n,f,s)}}};d.prototype.unescapedValue=function(t,r){var n=r.lookup(t[1]);if(n!=null)return n};d.prototype.escapedValue=function(t,r,n){var s=this.getConfigEscape(n)||g.escape,o=r.lookup(t[1]);if(o!=null)return typeof o=="number"&&s===g.escape?String(o):s(o)};d.prototype.rawValue=function(t){return t[1]};d.prototype.getConfigTags=function(t){return L(t)?t:t&&typeof t=="object"?t.tags:void 0};d.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!L(t))return t.escape};var g={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){M.templateCache=e},get templateCache(){return M.templateCache}},M=new d;g.clearCache=function(){return M.clearCache()};g.parse=function(t,r){return M.parse(t,r)};g.render=function(t,r,n,s){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+ce(t)+'" was given as the first argument for mustache#render(template, view, partials)');return M.render(t,r,n,s)};g.escape=me;g.Scanner=$;g.Context=S;g.Writer=d;var G=g;var J=async(e,t)=>{let r=await new Promise(n=>{e.getContent(s=>{n(s)})});return e.response.content={...e.response.content,text:r},G.render(`${t.trim()}`,e)};var y="har_report_settings";var Q=async()=>{let e=await fetch("./defaultTemplate.mustache");if(!e.body)throw"No template response";let t=e.body.getReader(),{value:r}=await t.read();return new TextDecoder().decode(r)};var V=async()=>{let e=await chrome.storage.local.get(y);return e[y]&&e[y].template?e[y].template:Q()};var X=async()=>{let e=await chrome.storage.local.get(y);return e[y]&&e[y].areAllMIMEtypesRendered?e[y].areAllMIMEtypesRendered==="on":!1};var Y=async e=>{let{status:t}=e.response,{method:r,url:n}=e.request,s=await V(),i=await X()||u.allowedResponseMimeTypesRegExps.find(a=>a.test(e.response.content.mimeType))!==void 0?await J(e,s):`<span style="opacity:0.5">HAR Report: Unsupported response content MIME type: "${e.response.content.mimeType}"</span>`;return{id:crypto.randomUUID().split("-").join(""),dateTime:e.startedDateTime,status:t,method:r,url:n,report:i}};var Z=()=>{let e=document.querySelector("#filter");if(!e)throw"#filter selector not found";e.addEventListener("input",t=>{let{value:r}=t.target;u.filter=r.trim(),Re()})},Re=()=>{for(let e of u.entries)_(e,u.filter)};{class e extends HTMLElement{isRecording=!1;constructor(){super()}connectedCallback(){this.isRecording=this.getAttribute("is-recording")=="true",this.createTemplate()}static get observedAttributes(){return["is-recording"]}attributeChangedCallback(r,n,s){switch(r){case"is-recording":this.isRecording=s==="true",this.createTemplate();break}}createTemplate(){this.innerHTML=`
        <div
          class="status-dot ${this.isRecording?"status-dot--recording":""}"
        ></div>
      `}}customElements.define("status-dot",e)}{class e extends HTMLElement{href=`chrome-extension://${chrome.runtime.id}/settings.html`;constructor(){super()}connectedCallback(){this.innerHTML=`
        \u2699\uFE0F
        <a href="${this.href}" target="_blank" class="link">
          Settings
        </a>
      `}}customElements.define("settings-link",e)}var ee=e=>new Promise((t,r)=>{let n=document.createElement("textarea");n.value=e,document.body.append(n),n.select();let s=document.execCommand("copy");n.remove(),s||r(new Error("Unable to write to clipboard")),t()});{let e;(n=>n.targetSelector="target-selector")(e||={});class t extends HTMLElement{constructor(){super()}createTemplate(){this.innerHTML=`
        <button type="button" class="copy">
          Copy
        </button>
      `}async copyAction(n){let s=this.getAttribute("target-selector");if(!s)throw"No target selector provided";let o=document.querySelector(s);if(!o)throw`No target element for ${s} selector`;let i=o.innerText,a=n.target;try{if(await ee(i),!n.target)return;a.innerText="Copied!",a.setAttribute("disabled","true"),setTimeout(()=>{a.innerText="Copy",a.removeAttribute("disabled")},750)}catch(c){console.error(c)}}appendEvents(){let n=this.querySelector("button");if(!n)throw"No button element found";n.addEventListener("click",this.copyAction.bind(this))}removeEvents(){this.querySelector("button")&&this.querySelector("button").removeEventListener("click",this.copyAction)}connectedCallback(){this.createTemplate(),this.appendEvents()}disconnectedCallback(){this.removeEvents()}}customElements.define("copy-button",t)}var te=e=>e<200?"":e<300?"success":e<400?"redirect":"fail";{let e;(n=>n.status="status")(e||={});class t extends HTMLElement{constructor(){super()}connectedCallback(){let n=this.getAttribute("status");this.innerHTML=`
        <span class="status ${n!==null?te(Number(n)):""}">
          ${n}
        </span>
      `}}customElements.define("response-status",t)}chrome.devtools.network.onRequestFinished.addListener(async e=>{if(!u.isRecording)return;if(!O(e._resourceType))throw"request._resourceType value is not a string";if(!u.allowedResourceTypes.includes(e._resourceType))throw`Resource type "${e._resourceType}" is not supported`;let t=await Y(e);u.entries.push(t),j(t)}),document.addEventListener("beforeunload",()=>{u.entries.length=0}),document.addEventListener("DOMContentLoaded",()=>{C("#reset",N),C("#pause",K),Z()});})();
/*! Bundled license information:

mustache/mustache.mjs:
  (*!
   * mustache.js - Logic-less {{mustache}} templates with JavaScript
   * http://github.com/janl/mustache.js
   *)
*/
